<!-- HTML header for doxygen 1.8.5-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>Intel(R) MKL-DNN: Reorder</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script src="assets/mathjax/MathJax.js?config=TeX-AMS_CHTML"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet">
<link href="assets/customdoxygen.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="assets/dnn.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
   <div id="projectname">Intel(R) Math Kernel Library for Deep Neural Networks (Intel(R) MKL-DNN)
   &#160;<span id="projectnumber">1.0.4</span>
   </div>
   <div id="projectbrief">Performance library for Deep Learning</div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Reorder </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><blockquote class="doxtable">
<p></p>
<p>API reference: <a class="el" href="group__c__api__reorder.html">C</a>, <a class="el" href="group__cpp__api__reorder.html">C++</a></p>
<p></p>
</blockquote>
<p>The reorder primitive copies data between different memory formats but doesn't change the tensor from mathematical perspective:</p>
<p class="formulaDsp">
\[ dst(\overline{x}) = src(\overline{x}) \]
</p>
<p>As described in <a class="el" href="dev_guide_basic_concepts.html">Basic Concepts</a> in order to achieve the best performance some primitives (such as convolution) require special memory format which is typically referred as an <em>optimized</em> memory format. The <em>optimized</em> memory format may match or may not match memory format that data is currently kept in. In this case a user can use reorder primitive to copy (reorder) the data between the memory formats.</p>
<p>Using the attributes and post-ops users can also use reorder primitive to quantize the data (and if necessary change the memory format simultaneously).</p>
<h2>Implementation Details</h2>
<h3>General Notes</h3>
<ol type="1">
<li>The reorder primitive requires the source and destination tensors to have the same shape. Implicit broadcasting is not supported.</li>
<li>While in most of the cases the reorder should be able to handle arbitrary source and destination memory formats and data types it might happen than some combinations are not implemented. For instance:<ul>
<li>Reorder implementations between weights in non-plain memory formats might be limited (but if encountered in real practice should be treated as a bug and reported to the Intel MKL-DNN team);</li>
<li>Weights in one Winograd format cannot be reordered to the weights of the other Winograd format;</li>
<li>Quantized weights for convolution with <a class="el" href="group__c__api__types__generic.html#gga826b2a9be4d94ac17f99bacac6d0cb29a8a09db71666549aebad36fd23d974180" title="8-bit signed integer. ">mkldnn_s8</a> source data type cannot be dequantized back to the <a class="el" href="group__c__api__types__generic.html#gga826b2a9be4d94ac17f99bacac6d0cb29a6d9faa3e054a4f7b7e5ab5b3d420684e" title="32-bit/single-precision floating point. ">mkldnn_f32</a> data type;</li>
</ul>
</li>
<li>To alleviate the problem a user may rely on fact that the reorder from original plain memory format and user's data type to the <em>optimized</em> format with chosen data type should be always implemented.</li>
</ol>
<h3>Data Types Support</h3>
<p>The reorder primitive supports arbitrary data types for the source and destination according to the <a class="el" href="dev_guide_data_types.html">Data Types</a> page.</p>
<p>When converting the data from one data type to a smaller one saturation is used. For instance:</p>
<div class="fragment"><div class="line">reorder(src={1024, data_type=f32}, dst={, data_type=s8})</div>
<div class="line"><span class="comment">// dst == {127}</span></div>
<div class="line"></div>
<div class="line">reorder(src={-124, data_type=f32}, dst={, data_type=u8})</div>
<div class="line"><span class="comment">// dst == {0}</span></div>
</div><!-- fragment --><h3>Data Representation</h3>
<p>The reorder primitive works with arbitrary data tensors. There is no special meaning associated with any logical dimensions.</p>
<h3>Post-ops and Attributes</h3>
<p>The reorder primitive support the following attributes and post-ops:</p>
<table class="doxtable">
<tr>
<th align="left">Attributes / Post-ops </th><th align="left">Meaning  </th></tr>
<tr>
<td align="left"><a class="el" href="group__c__api__attributes.html#ga415451b28b726c0641c3d32b98815fc2">Output scales</a> </td><td align="left">Copy and scale the data according to the scaling factors </td></tr>
<tr>
<td align="left"><a class="el" href="group__c__api__attributes__post__ops.html#ga172931a133db5d1a3605495ad877d364">Sum post-op</a> </td><td align="left">Instead of copy the data accumulate it to the previous data </td></tr>
</table>
<p>For instance, the following pseudo-code</p>
<div class="fragment"><div class="line">reorder(</div>
<div class="line">        src = {dims={N, C, H, W}, data_type=dt_src, memory_format=fmt_src},</div>
<div class="line">        dst = {dims={N, C, H, W}, data_type=dt_dst, memory_format=fmt_dst},</div>
<div class="line">        attr ={</div>
<div class="line">            output_scale=alpha,</div>
<div class="line">            post-ops = { sum={scale=beta} },</div>
<div class="line">        })</div>
</div><!-- fragment --><p>would lead to the following operation:</p>
<p class="formulaDsp">
\[ dst(\overline{x}) = \alpha \cdot src(\overline{x}) + \beta \cdot dst(\overline{x}) \]
</p>
<dl class="section note"><dt>Note</dt><dd>The intermediate operations are being done using single precision floating point data type.</dd></dl>
<h2>Implementation Limitations</h2>
<ol type="1">
<li>No primitive specific limitations. Refer to <a class="el" href="dev_guide_data_types.html">Data Types</a> for limitations related to data types support.</li>
</ol>
<h2>Performance Tips</h2>
<p>N/A </p>
</div></div><!-- contents -->
<div class="footer">
    <div class="footer-wrapper">
        <ul id="footer-links">
            <li><a href="legal_information.html">Legal information</a></li>
        </ul>
    </div>
</div>